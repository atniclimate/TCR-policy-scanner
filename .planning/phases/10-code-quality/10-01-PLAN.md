---
phase: 10-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - data/program_inventory.json
autonomous: true

must_haves:
  truths:
    - "All 16 programs in program_inventory.json have non-null cfda fields"
    - "All 16 programs have non-null access_type and funding_type fields"
    - "Programs that are not grant programs use 'N/A' with explanatory text"
    - "All existing tests still pass after inventory updates"
  artifacts:
    - path: "data/program_inventory.json"
      provides: "Complete program metadata for 16 tracked programs"
      contains: "cfda.*N/A"
  key_links:
    - from: "data/program_inventory.json"
      to: "src/scrapers/usaspending.py"
      via: "CFDA number used in award queries"
      pattern: "cfda"
---

<objective>
Complete all null cfda fields in program_inventory.json so every program has full metadata.

Purpose: QUAL-01 requires all 16 programs to have non-null values for cfda, access_type, and funding_type. Research found access_type and funding_type are already complete. Five programs have null cfda values that need resolution.
Output: Updated program_inventory.json with all 16 cfda fields populated.
</objective>

<execution_context>
@D:\Claude-Workspace\.claude/get-shit-done/workflows/execute-plan.md
@D:\Claude-Workspace\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-code-quality/10-RESEARCH.md
@data/program_inventory.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Research and populate 5 null CFDA fields</name>
  <files>data/program_inventory.json</files>
  <action>
Update the 5 programs with null cfda values in data/program_inventory.json. Use these researched values:

1. **irs_elective_pay** - Set cfda to `"N/A - IRC Section 6417 tax provision, not a grant program"`. This is a tax credit mechanism under the Inflation Reduction Act, not a federal assistance listing. There is no CFDA/ALN number.

2. **fema_tribal_mitigation** - Set cfda to `"97.047"`. This is the FEMA Hazard Mitigation Grant Program (HMGP) Pre-Disaster Mitigation for Tribes. ALN 97.047 covers the Pre-Disaster Mitigation program which includes Tribal set-asides. (Note: fema_bric already references ["97.047","97.039"] for BRIC; the Tribal mitigation planning component maps to 97.047.)

3. **noaa_tribal** - Set cfda to `"11.483"`. This is the NOAA Programs for Disaster Relief Appropriations Act - Loss Avoidance and Resilience Activities, which covers Tribal climate programs. If the program is more specifically the NOAA Climate Program Office Tribal grants, use 11.431 (Climate and Atmospheric Research). Use `"11.483"` as the primary.

4. **usbr_tap** - Set cfda to `"15.507"`. Bureau of Reclamation Technical Assistance Program falls under the WaterSMART umbrella. ALN 15.507 covers WaterSMART grants including the Technical Assistance to States component which includes Tribal entities.

5. **epa_tribal_air** - Set cfda to `"66.038"`. This is the EPA Clean Air Act Section 105 - Tribal Air Quality Management program (Assistance Listing 66.038).

**IMPORTANT:** Before writing, verify that `cfda` field values in the JSON are strings (or arrays of strings for programs with multiple CFDAs like fema_bric). For IRS elective pay, the "N/A" sentinel must be a string that starts with "N/A" so downstream code can detect it is not a real CFDA number.

**Verify downstream compatibility:** Check how `src/scrapers/usaspending.py` uses the `cfda` field. If it does numeric parsing or API queries with cfda values, ensure that "N/A" prefix values are filtered out before API calls. Add a brief code comment in program_inventory.json next to the N/A entry if helpful.
  </action>
  <verify>
Run: `python -c "import json; d=json.load(open('data/program_inventory.json','r',encoding='utf-8')); nulls=[p['id'] for p in d['programs'] if p.get('cfda') is None]; print(f'Null CFDAs: {len(nulls)}'); assert len(nulls) == 0, f'Still null: {nulls}'"` from F:\tcr-policy-scanner

Then run: `python -m pytest tests/ -q` to verify no test regressions.
  </verify>
  <done>All 16 programs have non-null cfda values. The 5 previously-null fields are populated with researched CFDA/ALN numbers (or "N/A" for the tax provision). All existing tests pass.</done>
</task>

</tasks>

<verification>
1. `python -c "import json; d=json.load(open('data/program_inventory.json','r',encoding='utf-8')); nulls=[p['id'] for p in d['programs'] if p.get('cfda') is None or p.get('access_type') is None or p.get('funding_type') is None]; print(f'Incomplete programs: {len(nulls)}'); assert len(nulls) == 0"` -- zero incomplete programs
2. `python -m pytest tests/ -q` -- 383+ tests pass
3. Spot-check: `python -c "import json; d=json.load(open('data/program_inventory.json','r',encoding='utf-8')); [print(f'{p[\"id\"]}: {p[\"cfda\"]}') for p in d['programs']]"` -- all 16 show values
</verification>

<success_criteria>
- All 16 programs have non-null cfda, access_type, and funding_type
- IRS elective pay uses "N/A" sentinel (not a grant program)
- 4 grant programs have real CFDA/ALN numbers
- All 383+ existing tests still pass
- QUAL-01 requirement is satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/10-code-quality/10-01-SUMMARY.md`
</output>

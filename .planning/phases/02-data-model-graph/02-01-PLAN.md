---
phase: 02-data-model-graph
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - data/policy_tracking.json
  - config/scanner_config.json
  - src/scrapers/grants_gov.py
autonomous: true

must_haves:
  truths:
    - "policy_tracking.json contains 7 status tiers including TERMINATED with a floor threshold and definition"
    - "scanner_config.json action_keywords contain broad reconciliation/repeal terms beyond IRA-specific language"
    - "scanner_config.json search_queries include reconciliation-focused Tribal search terms"
    - "grants_gov.py CFDA_NUMBERS dict maps 15.124 to bia_tcr_awards"
  artifacts:
    - path: "data/policy_tracking.json"
      provides: "7-tier CI threshold model with TERMINATED status"
      contains: "terminated_floor"
    - path: "config/scanner_config.json"
      provides: "Broad reconciliation/repeal trigger keywords for scanning"
      contains: "reconciliation bill"
    - path: "src/scrapers/grants_gov.py"
      provides: "CFDA mapping for BIA TCR Awards targeted scraping"
      contains: "15.124"
  key_links:
    - from: "data/policy_tracking.json"
      to: "ci_thresholds"
      via: "terminated_floor key in thresholds object"
      pattern: "terminated_floor"
    - from: "config/scanner_config.json"
      to: "src/analysis/relevance.py"
      via: "action_keywords consumed by relevance scorer"
      pattern: "reconciliation"
    - from: "src/scrapers/grants_gov.py"
      to: "data/program_inventory.json"
      via: "CFDA_NUMBERS maps CFDA to program_id matching inventory entry"
      pattern: "15\\.124.*bia_tcr_awards"
---

<objective>
Add TERMINATED as a 7th status tier to policy tracking, add broad reconciliation/repeal keywords to scanner config, and add BIA TCR Awards CFDA number to the Grants.gov scraper.

Purpose: Completes the DATA-02, DATA-04, and DATA-05 requirements -- the remaining data file gaps identified by research. These are JSON/config edits with one Python constant update, requiring no logic changes.

Output: Updated policy_tracking.json with 7-tier model, updated scanner_config.json with reconciliation keywords, updated grants_gov.py with CFDA 15.124 mapping.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-data-model-graph/02-RESEARCH.md

@data/policy_tracking.json
@config/scanner_config.json
@src/scrapers/grants_gov.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add TERMINATED status tier to policy tracking</name>
  <files>data/policy_tracking.json</files>
  <action>
  Edit `data/policy_tracking.json` to add TERMINATED as a 7th status tier:

  1. In the `ci_thresholds` object, raise `flagged_floor` from `0.0` to `0.10` and add `"terminated_floor": 0.0` as the new bottom tier. The final thresholds should be:
     ```json
     "ci_thresholds": {
       "secure": 0.90,
       "stable": 0.75,
       "stable_but_vulnerable": 0.65,
       "at_risk_floor": 0.40,
       "uncertain_floor": 0.25,
       "flagged_floor": 0.10,
       "terminated_floor": 0.0
     }
     ```

  2. In the `status_definitions` object, add the TERMINATED definition:
     ```json
     "TERMINATED": "Program confirmed terminated; advocacy pivots to replacement mechanism"
     ```

  Rationale for threshold values: FEMA BRIC is the only FLAGGED program at CI 0.12. Setting flagged_floor to 0.10 keeps BRIC correctly classified as FLAGGED (0.12 >= 0.10). TERMINATED at 0.0 floor is reserved for programs that are fully dead. This maintains backward compatibility.

  Do NOT change any program positions or their CI scores -- only the thresholds and definitions sections.
  </action>
  <verify>
  Run: `python -c "import json; pt=json.load(open('data/policy_tracking.json')); t=pt['ci_thresholds']; d=pt['status_definitions']; assert 'terminated_floor' in t and t['terminated_floor']==0.0; assert t['flagged_floor']==0.10; assert 'TERMINATED' in d; print('PASS: 7-tier model with TERMINATED')"`
  </verify>
  <done>policy_tracking.json has 7 CI thresholds (secure through terminated_floor) and 7 status definitions (SECURE through TERMINATED). FEMA BRIC (CI 0.12) remains correctly classified above the new flagged_floor of 0.10.</done>
</task>

<task type="auto">
  <name>Task 2: Add broad reconciliation/repeal keywords to scanner config</name>
  <files>config/scanner_config.json</files>
  <action>
  Edit `config/scanner_config.json` to add broad reconciliation and repeal trigger terms. Currently the config has IRA-specific terms only on individual program entries but lacks general reconciliation language in the shared scanner keywords.

  1. Add to the `action_keywords` array (these are general action types the scanner looks for):
     - "reconciliation"
     - "reconciliation bill"
     - "budget reconciliation"
     - "revenue offsets"
     - "repeal"
     - "section 6417"

  2. Add to the `search_queries` array (these are actual search terms sent to APIs):
     - "budget reconciliation tribal"
     - "IRA repeal tribal"
     - "reconciliation bill energy"
     - "section 6417 repeal"

  Append these to the END of each respective array (do not reorder existing entries). Verify no duplicates with existing entries before adding -- check that "rescission" and "termination" already exist in action_keywords (they do, so do not re-add them).

  Do NOT modify any other sections (sources, scoring, tribal_keywords, scan_window_days).
  </action>
  <verify>
  Run: `python -c "import json; c=json.load(open('config/scanner_config.json')); ak=c['action_keywords']; sq=c['search_queries']; assert 'reconciliation bill' in ak; assert 'budget reconciliation' in ak; assert 'revenue offsets' in ak; assert 'repeal' in ak; assert 'section 6417' in ak; assert 'budget reconciliation tribal' in sq; assert 'IRA repeal tribal' in sq; print(f'PASS: {len(ak)} action keywords, {len(sq)} search queries')"`
  </verify>
  <done>scanner_config.json action_keywords contain 6 new reconciliation/repeal terms. search_queries contain 4 new reconciliation-focused search terms. Total action keywords ~36, total search queries ~16.</done>
</task>

<task type="auto">
  <name>Task 3: Add BIA TCR Awards CFDA to Grants.gov scraper</name>
  <files>src/scrapers/grants_gov.py</files>
  <action>
  Edit `src/scrapers/grants_gov.py` to add CFDA number 15.124 for BIA TCR Awards to the `CFDA_NUMBERS` dict.

  Add this entry to the `CFDA_NUMBERS` dict (after the existing `"15.156": "bia_tcr"` entry for logical grouping):
  ```python
  "15.124": "bia_tcr_awards",  # BIA Tribal Community Resilience Annual Awards
  ```

  This enables targeted CFDA-based scraping for BIA TCR Awards on Grants.gov, matching the `cfda: "15.124"` field already present in the `bia_tcr_awards` entry in `program_inventory.json`.

  Do NOT modify any other code in this file -- only add the one dict entry.
  </action>
  <verify>
  Run: `python -c "from src.scrapers.grants_gov import CFDA_NUMBERS; assert '15.124' in CFDA_NUMBERS; assert CFDA_NUMBERS['15.124'] == 'bia_tcr_awards'; print(f'PASS: {len(CFDA_NUMBERS)} CFDA numbers, 15.124 -> bia_tcr_awards')"`
  </verify>
  <done>grants_gov.py CFDA_NUMBERS dict contains 12 entries (was 11), including "15.124" mapped to "bia_tcr_awards".</done>
</task>

</tasks>

<verification>
After all 3 tasks, run the full pipeline to confirm no regressions:

```bash
cd F:\tcr-policy-scanner
python -c "
import json

# 1. Verify 7-tier thresholds
pt = json.load(open('data/policy_tracking.json'))
thresholds = pt['ci_thresholds']
assert len(thresholds) == 7, f'Expected 7 thresholds, got {len(thresholds)}'
assert 'terminated_floor' in thresholds
assert thresholds['flagged_floor'] == 0.10
assert 'TERMINATED' in pt['status_definitions']

# 2. Verify reconciliation keywords
sc = json.load(open('config/scanner_config.json'))
assert 'reconciliation bill' in sc['action_keywords']
assert 'budget reconciliation tribal' in sc['search_queries']

# 3. Verify CFDA
from src.scrapers.grants_gov import CFDA_NUMBERS
assert '15.124' in CFDA_NUMBERS

# 4. Verify all 16 programs still load
inv = json.load(open('data/program_inventory.json'))
assert len(inv['programs']) == 16

# 5. Verify all 16 positions still load
assert len(pt['positions']) == 16

print('ALL CHECKS PASS')
"
```
</verification>

<success_criteria>
1. policy_tracking.json has 7 CI thresholds and 7 status definitions including TERMINATED
2. scanner_config.json has broad reconciliation/repeal terms in both action_keywords and search_queries
3. grants_gov.py CFDA_NUMBERS maps 15.124 to bia_tcr_awards
4. All existing data remains intact (16 programs, 16 positions, no schema changes)
</success_criteria>

<output>
After completion, create `.planning/phases/02-data-model-graph/02-01-SUMMARY.md`
</output>

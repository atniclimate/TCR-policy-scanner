---
phase: 15-congressional-intelligence
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/ENH-001-congressional-alerts.md
  - docs/ENH-002-knowledge-graph-congressional.md
  - docs/phase-15-integration-map.md
  - docs/data-completeness-roadmap.md
autonomous: true

must_haves:
  truths:
    - "ENH-001 spec describes a congressional alert system with change detection engine, alert classification (CRITICAL/HIGH/MEDIUM/LOW), per-Tribe routing, and 21 story points across 3 sprints"
    - "Phase integration map documents every handoff from Congress.gov API through context building through DOCX rendering through website delivery"
    - "Knowledge graph extension spec shows Bill, Legislator, Committee, Vote nodes with AFFECTS_PROGRAM, SPONSORED_BY, REFERRED_TO, REPRESENTS edges and query examples"
    - "Data completeness roadmap lists all 8 data sources with confidence scores, gap counts, and prioritized next steps"
  artifacts:
    - path: "docs/ENH-001-congressional-alerts.md"
      provides: "Congressional alert system architecture spec"
    - path: "docs/phase-15-integration-map.md"
      provides: "Phase 15 integration handoff map"
    - path: "docs/ENH-002-knowledge-graph-congressional.md"
      provides: "Knowledge graph congressional extension spec"
    - path: "docs/data-completeness-roadmap.md"
      provides: "Data source completeness and gap roadmap"
  key_links:
    - from: "docs/phase-15-integration-map.md"
      to: "docs/ENH-001-congressional-alerts.md"
      via: "Integration map references alert system as future phase"
---

<objective>
Create documentation artifacts for INTEL-12 (alert system architecture spec), INTEL-13 (integration map), INTEL-14 (knowledge graph spec with query examples), and INTEL-15 (data completeness roadmap).

Purpose: These docs specify future enhancements and document the Phase 15 system architecture for maintainability.

Output: 4 documentation files in docs/ directory.
</objective>

<execution_context>
@D:\Claude-Workspace\.claude/get-shit-done/workflows/execute-plan.md
@D:\Claude-Workspace\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-congressional-intelligence/15-RESEARCH.md
@.planning/phases/15-congressional-intelligence/15-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ENH-001 alert system spec and integration map</name>
  <files>docs/ENH-001-congressional-alerts.md, docs/phase-15-integration-map.md</files>
  <action>
**A) ENH-001 Congressional Alert System Architecture (docs/ENH-001-congressional-alerts.md):**

Create a specification document with these sections:

1. **Overview**: Congressional alert system that detects changes in bill status, committee referrals, and voting activity relevant to Tribal climate resilience programs. Triggered by daily scan diffs.

2. **Change Detection Engine**:
   - Compare current congressional_intel.json to previous scan
   - Detect: new bills introduced, status changes (committee action, floor vote, enrolled), new cosponsors, committee hearing scheduled
   - Delta format: list of (bill_id, change_type, old_value, new_value, timestamp)

3. **Alert Classification**:
   - CRITICAL: Bill passed chamber or enrolled (immediate action needed)
   - HIGH: Committee markup scheduled, floor vote scheduled, or bill amended
   - MEDIUM: New cosponsor from Tribe's delegation, committee referral
   - LOW: New related bill introduced, text version published

4. **Per-Tribe Routing**:
   - Route alerts to Tribes whose delegation sponsored/cosponsored the bill
   - Route to Tribes whose tracked programs are affected (via AFFECTS_PROGRAM edges)
   - Route to all Tribes in affected state for state-level legislation

5. **Delivery Mechanism** (future):
   - Alert digest appended to next DOCX generation
   - Optional: structured JSON alert feed for web widget consumption
   - No email/push -- T0 classification means no PII collection

6. **Story Points** (21 total across 3 sprints):
   - Sprint 1 (8 pts): Change detection engine + alert classification
   - Sprint 2 (8 pts): Per-Tribe routing + digest generation
   - Sprint 3 (5 pts): Integration with DOCX pipeline + testing

7. **Dependencies**: Requires Phase 15 congressional_intel.json, Pydantic models, confidence scoring.

**B) Phase 15 Integration Map (docs/phase-15-integration-map.md):**

Create a document showing every data handoff in Phase 15:

```
Congress.gov API v3
  |
  v
CongressGovScraper.scan() -- paginated bill search
  |
  v
CongressGovScraper._fetch_bill_detail() -- sub-endpoint fetches
  |
  v
BillIntelligence Pydantic model -- validation
  |
  v
bill_relevance_scoring() -- match bills to programs
  |
  v
data/congressional_intel.json -- cached bill intelligence
  |
  v
PacketOrchestrator.prepare_context() -- loads intel, builds context
  |
  v
TribePacketContext.congressional_intel -- per-Tribe filtered data
  |
  v
DocxEngine.generate() -- section ordering
  |
  v
render_bill_intelligence_section() -- Doc A/B/C/D renderers
  |
  v
confidence_level() -- HIGH/MEDIUM/LOW badges
  |
  v
DOCX file on disk
  |
  v
GitHub Pages / SquareSpace iframe -- Tribal Leader downloads
```

Include a table of file-to-file handoffs with data format at each boundary.
  </action>
  <verify>
Both files exist and contain the required sections:
- ENH-001 has: Overview, Change Detection, Alert Classification, Per-Tribe Routing, Story Points
- Integration map has: data flow diagram showing Congress.gov API through DOCX rendering
  </verify>
  <done>ENH-001 alert spec has 21 story points across 3 sprints; integration map documents every handoff from API to Tribal Leader.</done>
</task>

<task type="auto">
  <name>Task 2: Create knowledge graph spec and data completeness roadmap</name>
  <files>docs/ENH-002-knowledge-graph-congressional.md, docs/data-completeness-roadmap.md</files>
  <action>
**A) ENH-002 Knowledge Graph Congressional Extension (docs/ENH-002-knowledge-graph-congressional.md):**

Create a specification with:

1. **New Node Types**:
   - BillNode: id, congress, bill_type, bill_number, title, status, relevance_score, sponsor_id, introduced_date
   - LegislatorNode: id (bioguide_id), name, chamber, state, district, party
   - CommitteeNode: id (system_code), name, chamber (references existing congressional_cache structure)
   - VoteNode: id, bill_id, chamber, vote_date, result (future, pending Senate API availability)

2. **New Edge Types** with examples:
   - SPONSORED_BY: BillNode -> LegislatorNode (e.g., bill_119_hr_1234 -> C001120)
   - REFERRED_TO: BillNode -> CommitteeNode (e.g., bill_119_hr_1234 -> SLIA)
   - AFFECTS_PROGRAM: BillNode -> ProgramNode with relevance_score metadata
   - DELEGATES_TO: TribeNode -> LegislatorNode with overlap_pct metadata
   - MEMBER_OF: LegislatorNode -> CommitteeNode with role metadata
   - VOTED_ON: LegislatorNode -> VoteNode with vote metadata (future)
   - REPRESENTS: LegislatorNode -> TribeNode (inverse of DELEGATES_TO)

3. **Query Examples** (graph traversal patterns):
   - "Which bills affect programs tracked by Tribe X?" (Tribe -> Programs -> AFFECTS_PROGRAM -> Bills)
   - "Which of Tribe X's legislators sponsored relevant bills?" (Tribe -> DELEGATES_TO -> Legislators -> SPONSORED_BY -> Bills)
   - "Which committees have jurisdiction over Tribe X's programs?" (Bills -> REFERRED_TO -> Committees)

4. **Data Sources**: Congress.gov API v3 for bills/members, congressional_cache.json for delegations, graph_schema.json for programs.

**B) Data Completeness Roadmap (docs/data-completeness-roadmap.md):**

Create a document with:

1. **Current Data Sources** (8 total):

| Source | Coverage | Confidence | Gap Count | Next Step |
|--------|----------|------------|-----------|-----------|
| EPA Tribal Registry | 592/592 (100%) | HIGH | 0 | Stable |
| Congressional Cache | 501/592 (84.6%) | HIGH | 91 | Improve AIANNH crosswalk |
| USASpending Awards | 451/592 (76.2%) | HIGH | 141 | Housing authority alias curation |
| FEMA NRI Hazards | 573/592 (96.8%) | HIGH | 19 | Manual review of unmatched |
| USFS Wildfire | 573/592 (96.8%) | HIGH | 19 | Shared with NRI coverage |
| Congressional Intel | NEW | MEDIUM | TBD | Phase 15 delivery |
| Federal Register | N/A (scan-based) | HIGH | 0 | Pagination fix (Phase 15) |
| Grants.gov | N/A (scan-based) | MEDIUM | 0 | Pagination fix (Phase 15) |

2. **Gap Prioritization**:
   - P1: Congressional intel bill-to-program mapping (new capability)
   - P2: USASpending coverage (141 Tribes with zero awards)
   - P3: Congressional delegation coverage (91 unmapped Tribes)
   - P4: Hazard profile gaps (19 Tribes, mostly small Oklahoma Tribes)

3. **Confidence Scoring Per Program** (using new confidence module):
   - Show how each of 16 tracked programs gets a composite confidence score
   - Formula: weighted average of source confidences for data used in that program's packet sections
  </action>
  <verify>
Both files exist and contain required content:
- ENH-002 has: node types, edge types with examples, query examples
- Data roadmap has: 8-source coverage table, gap prioritization, confidence scoring description
  </verify>
  <done>Knowledge graph spec has 4 node types, 7 edge types, 3 query examples; data roadmap covers all 8 sources with gap counts and prioritization.</done>
</task>

</tasks>

<verification>
1. All 4 docs exist in docs/ directory
2. ENH-001 has 21 story points decomposed across 3 sprints
3. Integration map traces Congress.gov API through DOCX rendering to Tribal Leader
4. ENH-002 has query examples showing graph traversal patterns
5. Data roadmap lists all 8 data sources with coverage percentages
</verification>

<success_criteria>
- INTEL-12: Congressional alert system architecture fully specified in ENH-001
- INTEL-13: Phase integration map documents every handoff
- INTEL-14: Knowledge graph spec with congressional nodes, edges, and query examples (supplements schema code in Plan 01)
- INTEL-15: Data completeness roadmap with all 8 sources, confidence scores, and gap prioritization
</success_criteria>

<output>
After completion, create `.planning/phases/15-congressional-intelligence/15-03-SUMMARY.md`
</output>

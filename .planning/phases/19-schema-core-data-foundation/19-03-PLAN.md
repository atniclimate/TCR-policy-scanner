---
phase: 19-schema-core-data-foundation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/packets/vocabulary.py
  - tests/test_vocabulary.py
autonomous: true

must_haves:
  truths:
    - "SECTION_HEADINGS provides distinct heading strings for Doc A, B, C, D, E"
    - "RATING_LABEL is 'Resilience Investment Priority'"
    - "GAP_MESSAGES dict contains all 6 data gap messages with sovereignty framing"
    - "SVI_THEME3_EXCLUSION_NOTE contains full sovereignty-framing text"
    - "SVI_THEME3_SHORT contains abbreviated text for Doc B/D"
    - "FORBIDDEN_DOC_B_TERMS frozenset blocks strategy language in congressional docs"
    - "CONTEXT_SENSITIVE_TERMS maps 'vulnerability' to federal proper noun contexts only"
  artifacts:
    - path: "src/packets/vocabulary.py"
      provides: "Sovereignty-first framing constants module"
      contains: "SECTION_HEADINGS"
    - path: "tests/test_vocabulary.py"
      provides: "Tests for vocabulary constants completeness and air gap"
      contains: "test_section_headings"
  key_links:
    - from: "src/packets/vocabulary.py"
      to: "None (pure constants)"
      via: "frozen dataclass + dict constants"
      pattern: "@dataclass.*frozen=True"
---

<objective>
Create the sovereignty-first vulnerability framing vocabulary constants module with all approved language from user decisions.

Purpose: REG-04 requirement. Renderers import these constants at construction time instead of embedding raw vulnerability/resilience terminology. This module is the single source of truth for all framing language used in vulnerability sections across Doc A/B/C/D/E.

Output: `src/packets/vocabulary.py` with frozen dataclass constants and comprehensive test coverage.
</objective>

<execution_context>
@D:\Claude-Workspace\.claude/get-shit-done/workflows/execute-plan.md
@D:\Claude-Workspace\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-schema-core-data-foundation/19-RESEARCH.md

@.planning/phases/18.5-architectural-review/horizon-walker-report.md -- Option D Hybrid spec, Doc A/B voice assessment, full vocabulary analysis
@src/packets/doc_types.py -- Existing DocumentTypeConfig frozen dataclass pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sovereignty-first vocabulary constants module</name>
  <files>src/packets/vocabulary.py</files>
  <action>
    Create `src/packets/vocabulary.py` with these components:

    **1. Section headings (frozen dataclass):**
    ```python
    @dataclass(frozen=True)
    class SectionHeadings:
        """Section heading strings for vulnerability content by document type."""
        doc_a_main: str = "Climate Resilience Investment Profile"
        doc_b_main: str = "Climate Resilience Data Summary"
        doc_c_main: str = "Regional Climate Resilience Investment Profile"
        doc_d_main: str = "Regional Climate Resilience Data Summary"
        doc_e_main: str = "Climate Resilience Investment Assessment"

    SECTION_HEADINGS = SectionHeadings()
    ```

    **2. Rating label:**
    ```python
    RATING_LABEL: str = "Resilience Investment Priority"
    ```
    Full phrase used in documents: "Resilience Investment Priority: [tier]"

    **3. Tier display config (frozen dataclass):**
    ```python
    @dataclass(frozen=True)
    class TierDisplay:
        """Display configuration for an investment priority tier."""
        label: str      # e.g. "Critical"
        color_hex: str  # Hex color for badges/website
        description: str # One-line description

    TIER_DISPLAYS: dict[str, TierDisplay] = {
        "Critical": TierDisplay("Critical", "#DC2626", "Immediate and significant climate resilience investment needed"),
        "High": TierDisplay("High", "#EA580C", "Substantial climate resilience investment needed"),
        "Elevated": TierDisplay("Elevated", "#B45309", "Meaningful climate resilience investment needed"),
        "Moderate": TierDisplay("Moderate", "#2563EB", "Climate resilience investment beneficial"),
        "Low": TierDisplay("Low", "#16A34A", "Current resilience capacity addresses primary climate exposures"),
    }
    ```

    **4. Data gap messages (dict):**
    All 6 messages keyed by gap type string. Gap messages frame data absence as federal infrastructure failures, not Tribal deficiencies:
    ```python
    GAP_MESSAGES: dict[str, str] = {
        "MISSING_SVI": "CDC Social Vulnerability Index data is not available for this area. Federal social determinant surveys do not yet provide complete coverage for all Tribal geographic boundaries.",
        "PARTIAL_NRI": "FEMA National Risk Index data provides partial coverage for this Nation's geographic area. Scores reflect partial land area with federal hazard assessment.",
        "ZERO_AREA_WEIGHT": "Federal geographic datasets do not map county boundaries to this Nation's land area. This is a federal data infrastructure gap, not a reflection of climate exposure.",
        "ALASKA_PARTIAL": "Federal climate data infrastructure does not provide county-level coverage for Alaska. Available data reflects {available_sources}. Gaps represent federal assessment failures, not absence of climate risk.",
        "NO_COASTAL_DATA": "",
        "SOURCE_UNAVAILABLE": "{source_name} data was unavailable during the most recent data acquisition cycle. This profile will be updated when the source is restored.",
    }
    ```

    **5. Inline gap markers:**
    ```python
    INLINE_PARTIAL: str = "[partial coverage]"
    INLINE_GAP: str = "[federal data gap]"
    ```

    **6. SVI Theme 3 exclusion notes:**
    ```python
    SVI_THEME3_EXCLUSION_NOTE: str = (
        "Social Vulnerability Methodology\n\n"
        "This assessment uses a custom Tribal Social Vulnerability composite "
        "derived from three CDC SVI 2022 themes: Socioeconomic Status, "
        "Household Characteristics & Disability, and Housing Type & Transportation.\n\n"
        "The CDC SVI Theme 3 (Racial & Ethnic Minority Status) is intentionally "
        "excluded. Federal racial categorization frameworks impose external identity "
        "classifications that do not reflect Tribal Nations' self-determined "
        "understanding of community resilience factors. Tribal sovereignty includes "
        "the right to define which metrics meaningfully represent community "
        "conditions.\n\n"
        "The resulting 3-theme composite provides a methodologically sound and "
        "culturally appropriate measure of social determinants affecting climate "
        "resilience capacity."
    )

    SVI_THEME3_SHORT: str = "assessed using 3 CDC SVI themes"
    ```

    **7. Context-sensitive terms:**
    ```python
    CONTEXT_SENSITIVE_TERMS: dict[str, list[str]] = {
        "vulnerable": [
            "Social Vulnerability Index",
            "CDC/ATSDR Social Vulnerability",
        ],
        "vulnerability": [
            "Social Vulnerability Index",
            "National Risk Index",
            "Climate Vulnerability",
        ],
    }
    ```

    **8. Doc B / Doc D forbidden terms (extends existing air gap):**
    ```python
    FORBIDDEN_DOC_B_TERMS: frozenset[str] = frozenset({
        "strategic", "strategy", "leverage", "leveraging",
        "approach", "messaging", "talking point", "talking points",
        "assertive", "advocacy lever", "member approach",
        "investment priority", "investment profile",
        "resilience capacity", "adaptive capacity",
        "disproportionate", "disproportionately",
    })
    ```

    **9. Explanatory framing text:**
    ```python
    EXPOSURE_CONTEXT: str = "disproportionate exposure to climate hazards"
    COMPOSITE_METHODOLOGY_BRIEF: str = (
        "Composite score derived from FEMA National Risk Index hazard exposure, "
        "CDC Social Vulnerability Index social determinants, and NRI community "
        "resilience capacity assessment."
    )
    ```

    **Module-level docstring:** Document that this is a constants-only module. No classes with methods. No runtime computation. Renderers import these constants at construction time.

    **Import pattern:** Only `from dataclasses import dataclass`. No project imports. This is a leaf module with zero dependencies.
  </action>
  <verify>
    Run: `python -c "from src.packets.vocabulary import SECTION_HEADINGS, RATING_LABEL, GAP_MESSAGES, SVI_THEME3_EXCLUSION_NOTE, SVI_THEME3_SHORT, FORBIDDEN_DOC_B_TERMS, TIER_DISPLAYS; print('All imports OK')"` -- succeeds.
    Run: `python -c "from src.packets.vocabulary import SECTION_HEADINGS; assert SECTION_HEADINGS.doc_a_main == 'Climate Resilience Investment Profile'; print('Heading check OK')"` -- succeeds.
  </verify>
  <done>
    Vocabulary constants module exists at src/packets/vocabulary.py with all 9 component groups. All constants are importable. No project dependencies.
  </done>
</task>

<task type="auto">
  <name>Task 2: Write comprehensive vocabulary tests</name>
  <files>tests/test_vocabulary.py</files>
  <action>
    Create `tests/test_vocabulary.py` with these test classes:

    **TestSectionHeadings:**
    - test_all_five_doc_types_have_headings: Assert doc_a_main through doc_e_main are non-empty strings
    - test_headings_are_frozen: Attempting to set attribute raises FrozenInstanceError/AttributeError
    - test_no_vulnerability_in_headings: None of the heading strings contain the word "vulnerability" (framing decision)

    **TestRatingLabel:**
    - test_rating_label_value: Assert RATING_LABEL == "Resilience Investment Priority"
    - test_rating_label_no_vulnerability: "vulnerability" not in RATING_LABEL

    **TestTierDisplays:**
    - test_all_five_tiers_present: Set of keys == {"Critical", "High", "Elevated", "Moderate", "Low"}
    - test_tier_colors_are_valid_hex: Each color_hex matches #[0-9A-Fa-f]{6}
    - test_tier_displays_are_frozen: TierDisplay instances are frozen
    - test_tier_descriptions_non_empty: All descriptions are non-empty strings

    **TestGapMessages:**
    - test_all_six_gap_types_present: 6 keys in GAP_MESSAGES
    - test_missing_svi_message_content: Contains "CDC Social Vulnerability Index"
    - test_partial_nri_message_content: Contains "FEMA National Risk Index"
    - test_zero_area_weight_frames_as_federal_gap: Contains "federal data infrastructure gap"
    - test_alaska_partial_has_placeholder: Contains "{available_sources}"
    - test_no_coastal_data_is_empty: GAP_MESSAGES["NO_COASTAL_DATA"] == ""
    - test_source_unavailable_has_placeholder: Contains "{source_name}"

    **TestSVITheme3Notes:**
    - test_full_note_contains_sovereignty: "sovereignty" in SVI_THEME3_EXCLUSION_NOTE
    - test_full_note_mentions_three_themes: "three" in SVI_THEME3_EXCLUSION_NOTE.lower()
    - test_full_note_mentions_exclusion: "intentionally excluded" in SVI_THEME3_EXCLUSION_NOTE
    - test_short_note_is_brief: len(SVI_THEME3_SHORT) < 50
    - test_short_note_mentions_three_themes: "3 CDC SVI themes" in SVI_THEME3_SHORT

    **TestForbiddenTerms:**
    - test_forbidden_set_is_frozenset: isinstance check
    - test_contains_strategy_terms: "strategic" in set, "strategy" in set
    - test_contains_leverage_terms: "leverage" in set
    - test_minimum_term_count: len >= 10

    **TestContextSensitiveTerms:**
    - test_vulnerability_has_proper_noun_contexts: "vulnerability" key exists with at least 2 entries
    - test_vulnerable_has_proper_noun_contexts: "vulnerable" key exists
    - test_all_contexts_are_proper_nouns: Each string starts with uppercase

    **TestAirGapIntegrity:**
    - test_section_headings_not_in_forbidden: No word from FORBIDDEN_DOC_B_TERMS appears in any SECTION_HEADINGS value
    - test_gap_messages_sovereignty_framing: All non-empty gap messages frame gaps as federal infrastructure issues (contain "federal" somewhere)
  </action>
  <verify>
    Run: `python -m pytest tests/test_vocabulary.py -v` -- all tests pass.
    Run: `python -m pytest tests/ -x -q` -- all tests pass (no regressions).
  </verify>
  <done>
    Comprehensive vocabulary test suite with 25+ tests covering all constant groups, air gap integrity, sovereignty framing, and immutability. All tests pass.
  </done>
</task>

</tasks>

<verification>
1. `python -c "from src.packets.vocabulary import *"` -- all constants importable
2. `python -m pytest tests/test_vocabulary.py -v` -- all vocabulary tests pass
3. `python -m pytest tests/ -x -q` -- all 964+ tests pass
4. `grep -c "vulnerability" src/packets/vocabulary.py` -- "vulnerability" only appears inside federal proper noun strings, not in headings or labels
</verification>

<success_criteria>
- src/packets/vocabulary.py exists as a pure constants module with zero project dependencies
- All 9 constant groups present: SECTION_HEADINGS, RATING_LABEL, TIER_DISPLAYS, GAP_MESSAGES, INLINE_PARTIAL/GAP, SVI_THEME3_EXCLUSION_NOTE/SHORT, CONTEXT_SENSITIVE_TERMS, FORBIDDEN_DOC_B_TERMS, EXPOSURE_CONTEXT/COMPOSITE_METHODOLOGY_BRIEF
- 25+ tests covering completeness, air gap, sovereignty framing, and immutability
- All existing tests pass with zero regressions
</success_criteria>

<output>
After completion, create `.planning/phases/19-schema-core-data-foundation/19-03-SUMMARY.md`
</output>

{
  "agent": "Dale Gribble",
  "clone_id": "client-side|server-side",
  "timestamp": "2026-02-13T22:45:00Z",
  "findings": [
    {
      "id": "DALE-001",
      "severity": "important",
      "category": "third-party-risk",
      "threat": "Fuse.js library bundled locally but no Subresource Integrity (SRI) verification on the file. If the local copy is tampered with (supply chain attack during CI/CD, compromised developer workstation, or malicious PR), the altered fuse.min.js executes with full DOM access and could exfiltrate Tribe selection patterns or modify download URLs.",
      "evidence": "<script src=\"js/fuse.min.js\"></script> in index.html line 63. No integrity attribute. The file is bundled locally (good), but there is no hash verification that the bundled copy matches the official Fuse.js 7.1.0 release.",
      "attack_vector": "Attacker compromises the fuse.min.js file during a build step or via a malicious pull request. The tampered script intercepts Tribe search queries and selection events. No integrity check catches the modification.",
      "sovereignty_impact": "A compromised search library could silently log which Tribes are being looked up, revealing usage patterns (which Tribes are requesting packets, when, and how often). This violates CARE principle (Authority to Control) because the data controller loses visibility into what data leaves the browser.",
      "fix": "Generate a SHA-384 hash of the official Fuse.js 7.1.0 UMD build and add SRI: <script src=\"js/fuse.min.js\" integrity=\"sha384-HASH\" crossorigin=\"anonymous\"></script>. Also verify the hash in the CI/CD pipeline.",
      "paranoia_level": "cautious"
    },
    {
      "id": "DALE-002",
      "severity": "important",
      "category": "data-sovereignty",
      "threat": "The manifest.json file at docs/web/data/manifest.json contains deployed_at timestamp and total_documents count. Anyone can access this file without authentication. Combined with the tribes.json file (which lists all 592 Tribes with their document availability), an adversary can enumerate the complete set of Tribal Nations with advocacy packets and monitor when new packets are deployed.",
      "evidence": "docs/web/data/manifest.json is a publicly accessible static file on GitHub Pages. tribes.json contains the full list of 592 Tribes with document paths.",
      "attack_vector": "Automated scraper polls manifest.json and tribes.json to track which Tribes have active advocacy packets, when they were last updated, and whether they have internal strategy vs. congressional overview documents. This creates an intelligence profile of Tribal advocacy activity.",
      "sovereignty_impact": "Violates OCAP Ownership and Control principles. Tribal Nations should be able to control who knows about their advocacy activities. A public manifest allows any political opponent, industry group, or bad actor to monitor which Tribes are actively preparing climate resilience advocacy materials. The T0 classification makes this data publicly accessible by design, but the manifest amplifies the intelligence value by providing temporal tracking.",
      "fix": "This is an inherent tradeoff of GitHub Pages static hosting. Mitigation options: (1) Remove the manifest.json endpoint (it exists for deployment verification, not user-facing), (2) Rate-limit access via Cloudflare Workers or similar edge proxy if the site moves off GitHub Pages, (3) Accept the risk given T0 classification -- this data is intentionally public. Recommend documenting this exposure in the TSDF assessment.",
      "paranoia_level": "cautious"
    },
    {
      "id": "DALE-003",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "GitHub Pages serves static files directly. Every DOCX download creates a request log entry in GitHub infrastructure that includes the downloader IP address, User-Agent, timestamp, and the specific Tribe document path. GitHub privacy policy allows them to retain server logs. This means GitHub has a complete record of who downloaded which Tribe advocacy packet.",
      "evidence": "Download links point to tribes/internal/EPA_ID.docx and tribes/congressional/EPA_ID.docx on GitHub Pages. Each download is a standard HTTP GET logged by GitHub CDN.",
      "attack_vector": "A legal subpoena or data breach at GitHub could reveal the download log, showing which IP addresses accessed which Tribal advocacy documents.",
      "sovereignty_impact": "Partial violation of CARE Responsibility principle. The hosting provider (GitHub) has access to usage patterns that the data controller (the program team) cannot audit or delete. However, this is standard for any static hosting provider and is disclosed in GitHub privacy policy.",
      "fix": "Accept the risk for current deployment. If strict IP privacy is needed, serve downloads through a privacy-respecting CDN or on-premise hosting. The TSDF T0 classification acknowledges this data is public.",
      "paranoia_level": "cautious"
    },
    {
      "id": "DALE-004",
      "severity": "cosmetic",
      "category": "security",
      "threat": "No Content-Security-Policy header on GitHub Pages. GitHub Pages does not support custom HTTP headers. This means there is no CSP to restrict script sources. However, the site uses no inline scripts, no dynamic code generation, and no dynamic script creation.",
      "evidence": "GitHub Pages serves static files without custom headers. The HTML has no meta CSP tag. All JS is in external files, no inline event handlers.",
      "attack_vector": "Without CSP, a successful XSS injection (currently none exist -- all DOM ops use textContent) would have no policy-level mitigation. The attack surface is minimal because the site is static with no user input persisted anywhere.",
      "sovereignty_impact": "Low. CSP is defense-in-depth. The primary defense (textContent, no innerHTML) is already in place.",
      "fix": "Add a meta CSP tag: <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self';\">. This provides CSP even without server header support.",
      "paranoia_level": "cautious"
    },
    {
      "id": "DALE-005",
      "severity": "cosmetic",
      "category": "data-sovereignty",
      "threat": "The SquareSpace iframe embed comment in index.html exposes the deployment pattern. While HTML comments are not rendered, they are visible in page source and could reveal the deployment architecture to anyone inspecting the HTML.",
      "evidence": "docs/web/index.html line 67: embed comment with iframe sandbox permissions",
      "attack_vector": "View source reveals the iframe embedding instructions and sandbox permissions. An attacker could craft a lookalike page with a modified iframe to phish Tribal staff.",
      "sovereignty_impact": "Low. The comment is deployment documentation, not sensitive data. The generic URL post-fix is less revealing than a specific organizational URL.",
      "fix": "Consider moving embed instructions to a deployment guide document. Low priority.",
      "paranoia_level": "tinfoil-hat"
    },
    {
      "id": "DALE-006",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "No tracking scripts or analytics found. Zero third-party JavaScript. Zero external font loading. Zero cookies set. The site is analytics-free, which is excellent for data sovereignty.",
      "evidence": "Searched all HTML, CSS, and JS files for: google-analytics, gtag, gtm, facebook, pixel, hotjar, mixpanel, amplitude, segment, heap, fullstory, mouseflow, clarity, fonts.googleapis.com, fonts.gstatic.com, document.cookie, setCookie, localStorage (analytics). None found.",
      "attack_vector": "None. The site is clean.",
      "sovereignty_impact": "Positive. Full compliance with XCUT-02 data sovereignty requirement. No third-party tracking or phone-home behavior.",
      "fix": "No fix needed. Maintain this standard. Add a test to detect any future addition of tracking scripts.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-007",
      "severity": "cosmetic",
      "category": "trust-boundary",
      "threat": "The SquareSpace iframe sandbox attribute includes allow-same-origin. Combined with allow-scripts, this technically allows the iframe content to access its own origin cookies and storage. However, since the iframe source is on GitHub Pages (a different origin than SquareSpace), the same-origin policy prevents cross-origin access. The sandbox is correctly configured.",
      "evidence": "sandbox=\"allow-scripts allow-same-origin allow-downloads allow-popups\" in the embed comment.",
      "attack_vector": "A malicious SquareSpace plugin running on the parent page cannot access the iframe content due to same-origin policy. The iframe is sandboxed correctly.",
      "sovereignty_impact": "None. The trust boundary between SquareSpace parent and GitHub Pages iframe is correctly maintained by browser same-origin policy.",
      "fix": "No fix needed. The sandbox permissions are minimal and correct.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-008",
      "severity": "cosmetic",
      "category": "security",
      "threat": "API keys are stored in GitHub Secrets and passed via environment variables in workflow YAML. The CONGRESS_API_KEY and SAM_API_KEY are never exposed in committed code, HTML, or JavaScript bundle.",
      "evidence": "Searched all files for patterns: api_key, apikey, token, secret, password, credential. Found only environment variable references in workflow YAML via secrets context. No keys in source code.",
      "attack_vector": "None. Keys are properly managed through GitHub Secrets.",
      "sovereignty_impact": "None. No credentials exposed.",
      "fix": "No fix needed. Current practice is correct.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-009",
      "severity": "cosmetic",
      "category": "security",
      "threat": "No source maps found in the web directory. The JavaScript files are not minified (except fuse.min.js which is a third-party library). Since there is no build step, there are no source maps to expose.",
      "evidence": "No .map files in docs/web/js/. The JS files are the original source with no obfuscation.",
      "attack_vector": "None specific to source maps. The source code is already readable but contains no sensitive logic.",
      "sovereignty_impact": "None. The JavaScript contains no sensitive logic -- it is a search-and-download UI.",
      "fix": "No fix needed. Source maps are a non-issue for this architecture.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-010",
      "severity": "cosmetic",
      "category": "security",
      "threat": "URL manipulation could allow downloading any file in the tribes/ directory. The download URLs are relative paths. However, GitHub Pages normalizes paths and prevents directory traversal.",
      "evidence": "Download URLs constructed client-side from tribes.json paths. GitHub Pages serves files within the published directory only.",
      "attack_vector": "Path traversal attempts are blocked at the CDN level by GitHub Pages. All files in tribes/ are intentionally public T0 documents.",
      "sovereignty_impact": "Low. All packets are public by design. No secret content to access via URL manipulation.",
      "fix": "No fix needed. GitHub Pages path normalization prevents traversal. T0 classification means all packets are public.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-011",
      "severity": "cosmetic",
      "category": "data-sovereignty",
      "threat": "TSDF T0 classification is documented in CLAUDE.md and enforced by the pipeline, but not displayed to website users. Tribal staff downloading documents have no visible indicator that the data sovereignty framework is being followed.",
      "evidence": "No TSDF badge, disclaimer, or data sovereignty statement on the website. The footer says only 'Tribal Climate Resilience Program'.",
      "attack_vector": "Not a security attack, but a trust deficit. Without visible TSDF compliance, Tribal staff may not trust the site with their usage patterns.",
      "sovereignty_impact": "Moderate. UNDRIP Article 18 and CARE Responsibility principle suggest data governance should be transparent to data subjects.",
      "fix": "Add a brief data sovereignty statement to the footer or as a separate page. This is a cosmetic UX enhancement.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-012",
      "severity": "cosmetic",
      "category": "trust-boundary",
      "threat": "The noscript fallback informs users JavaScript is required but provides no alternative path to documents.",
      "evidence": "noscript message in index.html.",
      "attack_vector": "Not a security issue. Users with JS disabled see a clear message but have no alternative.",
      "sovereignty_impact": "Minor. Users in restrictive environments may have JS disabled and need alternatives.",
      "fix": "Consider adding a direct link to the GitHub repository in the noscript message. Low priority.",
      "paranoia_level": "tinfoil-hat"
    },
    {
      "id": "DALE-013",
      "severity": "cosmetic",
      "category": "security",
      "threat": "GitHub Pages enforces HTTPS by default. All DOCX files served over TLS. HSTS header set by GitHub Pages infrastructure. MITM prevented by TLS.",
      "evidence": "GitHub Pages forces HTTPS redirect. Certificate managed by GitHub.",
      "attack_vector": "MITM is prevented by TLS. SquareSpace-to-GitHub-Pages connection also over HTTPS.",
      "sovereignty_impact": "None. Transport security properly implemented.",
      "fix": "No fix needed.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-014",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "No PII in DOCX filenames or URLs. Filenames are EPA IDs which are public registry identifiers.",
      "evidence": "Download hrefs use tribes/internal/{epa_id}_doc_a.docx pattern. EPA IDs are public from the EPA NCOD registry.",
      "attack_vector": "None. EPA IDs are not PII.",
      "sovereignty_impact": "None. No personally identifiable information.",
      "fix": "No fix needed.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-015",
      "severity": "cosmetic",
      "category": "third-party-risk",
      "threat": "GitHub Actions workflows use pinned major versions of official actions (v4/v5). SHA-pinned versions would be more secure.",
      "evidence": "deploy-website.yml and generate-packets.yml use: actions/checkout@v4, actions/setup-python@v5.",
      "attack_vector": "A compromised GitHub Action tag could inject malicious code. SHA-pinning eliminates tag mutability risk.",
      "sovereignty_impact": "Low. CI/CD generates public advocacy documents. Quality review catches modifications.",
      "fix": "Pin GitHub Actions to specific commit SHAs. Low priority given public nature of documents.",
      "paranoia_level": "cautious"
    },
    {
      "id": "DALE-016",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "The git commit automation uses a service account email (scanner@tcr-policy-scanner.local). This prevents exposing real developer emails.",
      "evidence": "git config user.email in workflow YAML files.",
      "attack_vector": "None. Developer privacy maintained.",
      "sovereignty_impact": "Positive. Developer privacy maintained.",
      "fix": "No fix needed.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-017",
      "severity": "cosmetic",
      "category": "security",
      "threat": "No cookies, localStorage, sessionStorage, or indexedDB used. The site is fully stateless.",
      "evidence": "Searched all JS files for storage APIs. None found.",
      "attack_vector": "None. No client-side storage means no session hijacking or tracking.",
      "sovereignty_impact": "Positive. Full CARE compliance on client-side data minimization.",
      "fix": "No fix needed.",
      "paranoia_level": "justified"
    },
    {
      "id": "DALE-018",
      "severity": "cosmetic",
      "category": "third-party-risk",
      "threat": "System fonts only. No Google Fonts, no external font CDN, no font-loading phone-home.",
      "evidence": "CSS uses system font stack. No @font-face declarations. No external font URLs.",
      "attack_vector": "None. System fonts never make network requests.",
      "sovereignty_impact": "Positive. No third-party font provider can track usage patterns.",
      "fix": "No fix needed. Maintain this standard.",
      "paranoia_level": "justified"
    }
  ],
  "third_party_inventory": [
    "github.com (hosting, CI/CD, static file serving)",
    "api.congress.gov (scraper: legislative data, requires API key, server-side only)",
    "api.usaspending.gov (scraper: spending data, no auth, server-side only)",
    "www.grants.gov (scraper: grant opportunities, no auth, server-side only)",
    "www.federalregister.gov (scraper: policy documents, no auth, server-side only)"
  ],
  "data_flow_map": "Client-side: User browser -> GitHub Pages (HTTPS) -> static HTML/CSS/JS + tribes.json -> local Fuse.js search -> DOCX download (direct file serve). Server-side (CI/CD only): GitHub Actions -> 4 federal API scrapers -> Python pipeline -> DOCX generation -> git push to docs/web/tribes/. No user data flows from client to server. No analytics. No cookies. No server-side processing of user requests.",
  "sovereignty_assessment": "The TCR Policy Scanner website substantially honors Indigenous Data Sovereignty principles. Strengths: (1) Zero analytics/tracking -- full CARE Collective Benefit compliance, (2) System fonts only -- no third-party font provider tracking, (3) No cookies or client-side storage -- data minimization, (4) All data is T0 (public) by design -- TSDF classification enforced at pipeline level, (5) API keys secured in GitHub Secrets, never in client code, (6) Service account email in CI/CD -- developer privacy maintained. Gaps: (1) No visible TSDF/sovereignty statement on the website for user trust (DALE-011), (2) GitHub Pages access logs are outside program audit control (DALE-003), (3) Public manifest enables temporal monitoring of advocacy activity (DALE-002), (4) No SRI hash on bundled fuse.min.js (DALE-001). Overall: the system is well-designed for data sovereignty. The gaps are inherent to static hosting platforms and do not constitute violations of UNDRIP, OCAP, or CARE principles for T0 data."
}

{
  "agent": "Dale Gribble",
  "clone_id": "client-side|server-side",
  "timestamp": "2026-02-14T00:22:00Z",
  "audit_wave": 2,
  "previous_audit": "2026-02-13T22:45:00Z",
  "context": "Post-fix re-audit after Plan 18-04 security/trust hardening. CSP meta tag, privacy footer, SHA-pinned Actions, and SRI hash all verified.",
  "findings": [
    {
      "id": "DALE-001",
      "severity": "important",
      "category": "third-party-risk",
      "threat": "ORIGINAL: Fuse.js library had no Subresource Integrity verification.",
      "evidence": "<script src=\"js/fuse.min.js\" integrity=\"sha384-P/y/5cwqUn6MDvJ9lCHJSaAi2EoH3JSeEdyaORsQMPgbpvA+NvvUqik7XH2YGBjb\" crossorigin=\"anonymous\"></script> in index.html line 70.",
      "attack_vector": "Mitigated. SRI hash now prevents execution if file is tampered. Browser will refuse to execute if hash does not match.",
      "sovereignty_impact": "Resolved. Supply chain protection in place.",
      "fix": "SRI integrity attribute added.",
      "paranoia_level": "justified",
      "fix_status": "verified_fixed",
      "fix_applied": "18-02 (924e9ac): Added SRI integrity='sha384-...' crossorigin='anonymous' to fuse.min.js script tag.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-002",
      "severity": "important",
      "category": "data-sovereignty",
      "threat": "ORIGINAL: Public manifest.json and tribes.json enable enumeration of all 592 Tribal advocacy packets.",
      "evidence": "manifest.json and tribes.json remain publicly accessible on GitHub Pages. This is by design for T0 (Open) data.",
      "attack_vector": "Inherent to static hosting of T0 data. Cannot be mitigated without moving off GitHub Pages or adding authentication (which would contradict T0 classification).",
      "sovereignty_impact": "Accepted. T0 classification explicitly acknowledges all data is publicly accessible. All data derived from public EPA NCOD registry.",
      "fix": "Risk accepted per TSDF T0 framework. Decision DEC-1802-01.",
      "paranoia_level": "cautious",
      "fix_status": "accepted",
      "fix_applied": "Risk acceptance documented in synthesis. T0 data is public by design.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-003",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "GitHub Pages access logs are outside program audit control. Every DOCX download creates a log entry with IP, User-Agent, timestamp, and document path.",
      "evidence": "Standard GitHub Pages infrastructure logging. No change from previous audit.",
      "attack_vector": "Legal subpoena or data breach at GitHub could reveal download patterns.",
      "sovereignty_impact": "Partial CARE Responsibility concern. Hosting provider controls access logs. Standard for all static hosting.",
      "fix": "Accept for current deployment. If strict IP privacy needed, migrate to privacy-respecting hosting.",
      "paranoia_level": "cautious",
      "fix_status": "deferred",
      "deferral_reason": "Inherent to GitHub Pages. Standard for all static hosting platforms."
    },
    {
      "id": "DALE-004",
      "severity": "cosmetic",
      "category": "security",
      "threat": "ORIGINAL: No Content-Security-Policy on the site.",
      "evidence": "<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self'; font-src 'self'; connect-src 'self'; frame-ancestors 'self' *.squarespace.com\"> in index.html line 7.",
      "attack_vector": "Mitigated. CSP meta tag now restricts script sources to 'self' only. No external scripts can execute. style-src allows 'unsafe-inline' for browser-injected styles. frame-ancestors allows SquareSpace embedding.",
      "sovereignty_impact": "Improved. Defense-in-depth CSP policy prevents script injection even if XSS vector were discovered.",
      "fix": "CSP meta tag added with restrictive policy.",
      "paranoia_level": "justified",
      "fix_status": "verified_fixed",
      "fix_applied": "18-04 (d3d18af): Added <meta http-equiv='Content-Security-Policy'> with default-src 'self', script-src 'self', style-src 'self' 'unsafe-inline', img-src 'self', font-src 'self', connect-src 'self', frame-ancestors 'self' *.squarespace.com.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-005",
      "severity": "cosmetic",
      "category": "data-sovereignty",
      "threat": "The SquareSpace iframe embed comment exposed deployment pattern.",
      "evidence": "Searched index.html for embed comment. Not found in current version. The embed comment was removed or genericized in 18-04.",
      "attack_vector": "Reduced. No deployment-specific URLs in page source.",
      "sovereignty_impact": "Low. Improved from previous state.",
      "fix": "Embed comment removed/genericized.",
      "paranoia_level": "tinfoil-hat",
      "fix_status": "verified_fixed",
      "fix_applied": "18-04 (d3d18af): Embed comment removed from index.html per plan action.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-006",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "Positive finding: Zero tracking scripts, zero analytics, zero third-party JavaScript, zero external font loading, zero cookies.",
      "evidence": "Re-searched all HTML, CSS, and JS files. Confirmed: no google-analytics, gtag, gtm, facebook, pixel, hotjar, mixpanel, amplitude, segment, heap, fullstory, mouseflow, clarity, fonts.googleapis.com, document.cookie. The CSP meta tag further enforces this by restricting script-src to 'self'.",
      "attack_vector": "None. The CSP now provides policy-level enforcement of the no-tracking practice.",
      "sovereignty_impact": "Positive. Full CARE Collective Benefit compliance. CSP prevents accidental addition of third-party scripts.",
      "fix": "No fix needed. Maintain this standard.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-007",
      "severity": "cosmetic",
      "category": "trust-boundary",
      "threat": "SquareSpace iframe sandbox correctly configured.",
      "evidence": "Same-origin policy prevents cross-origin access between SquareSpace parent and GitHub Pages iframe.",
      "attack_vector": "None. Trust boundary correctly maintained.",
      "sovereignty_impact": "None.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-008",
      "severity": "cosmetic",
      "category": "security",
      "threat": "API keys stored in GitHub Secrets, never in client code.",
      "evidence": "Re-searched all files. CONGRESS_API_KEY and SAM_API_KEY only in workflow YAML via ${{ secrets.* }} context.",
      "attack_vector": "None.",
      "sovereignty_impact": "None.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-009",
      "severity": "cosmetic",
      "category": "security",
      "threat": "No source maps in web directory.",
      "evidence": "No .map files. JS files are original source (no build step).",
      "attack_vector": "None.",
      "sovereignty_impact": "None.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-010",
      "severity": "cosmetic",
      "category": "security",
      "threat": "URL manipulation for path traversal prevented by GitHub Pages.",
      "evidence": "All packets are T0 public data. GitHub Pages normalizes paths.",
      "attack_vector": "None.",
      "sovereignty_impact": "Low.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-011",
      "severity": "cosmetic",
      "category": "data-sovereignty",
      "threat": "ORIGINAL: No visible TSDF/sovereignty statement on the website.",
      "evidence": "Footer now contains: <p class=\"footer-privacy\">No tracking. No cookies. Your searches stay on your device.</p> in index.html line 68.",
      "attack_vector": "Mitigated. Users now see an explicit privacy statement that builds trust.",
      "sovereignty_impact": "Improved. CARE Responsibility principle addressed -- users informed about data handling. The statement is accurate: the site has zero tracking, zero cookies, and all search is client-side (Fuse.js local search, no server queries).",
      "fix": "Privacy/sovereignty footer statement added.",
      "paranoia_level": "justified",
      "fix_status": "verified_fixed",
      "fix_applied": "18-04 (d3d18af): Added <p class='footer-privacy'>No tracking. No cookies. Your searches stay on your device.</p> to footer.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-012",
      "severity": "cosmetic",
      "category": "trust-boundary",
      "threat": "noscript fallback now provides an alternative path.",
      "evidence": "index.html line 44: <noscript><p class=\"status-message\">This tool requires JavaScript. For direct access to documents, visit the <a href=\"https://github.com/atniclimate/TCR-policy-scanner/\">TCR Policy Scanner repository</a>.</p></noscript>",
      "attack_vector": "Improved. Users with JS disabled now have a direct link to the repository.",
      "sovereignty_impact": "Minor improvement. Users in restrictive environments have a fallback path.",
      "fix": "noscript now links to GitHub repository.",
      "paranoia_level": "tinfoil-hat",
      "fix_status": "verified_fixed",
      "fix_applied": "18-04 (786938a): Added repository link in noscript fallback message.",
      "fix_verified_at": "2026-02-14T00:22:00Z"
    },
    {
      "id": "DALE-013",
      "severity": "cosmetic",
      "category": "security",
      "threat": "HTTPS enforced by GitHub Pages. HSTS header set. MITM prevented by TLS.",
      "evidence": "No change. GitHub Pages forces HTTPS redirect.",
      "attack_vector": "None.",
      "sovereignty_impact": "None.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-014",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "No PII in filenames or URLs. EPA IDs are public registry identifiers.",
      "evidence": "No change. Download hrefs use EPA ID pattern.",
      "attack_vector": "None.",
      "sovereignty_impact": "None.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-015",
      "severity": "cosmetic",
      "category": "third-party-risk",
      "threat": "ORIGINAL: GitHub Actions workflows used pinned major version tags (v4/v5) instead of commit SHAs.",
      "evidence": "deploy-website.yml and generate-packets.yml now use SHA-pinned actions: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 (v4), actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065 (v5). However, daily-scan.yml still uses version tags: actions/checkout@v4, actions/setup-python@v5.",
      "attack_vector": "Partially mitigated. The two primary deployment workflows are SHA-pinned. daily-scan.yml remains on version tags. A compromised tag could inject malicious code into the daily scan workflow, potentially affecting data integrity of scan outputs.",
      "sovereignty_impact": "Low. daily-scan.yml generates scan reports, not public-facing documents. The deployment workflows (which produce public DOCX and website content) are properly SHA-pinned.",
      "fix": "Pin daily-scan.yml actions to the same commit SHAs used in deploy-website.yml and generate-packets.yml.",
      "paranoia_level": "cautious",
      "fix_status": "partially_fixed",
      "fix_applied": "18-04 (d3d18af): deploy-website.yml and generate-packets.yml SHA-pinned. daily-scan.yml was not updated.",
      "fix_verified_at": "2026-02-14T00:22:00Z",
      "remaining_action": "Pin daily-scan.yml actions to SHA. New P3 finding (DALE-019)."
    },
    {
      "id": "DALE-016",
      "severity": "cosmetic",
      "category": "privacy",
      "threat": "Positive: Service account email in git config protects developer privacy.",
      "evidence": "All workflow YAML files use: scanner@tcr-policy-scanner.local.",
      "attack_vector": "None.",
      "sovereignty_impact": "Positive.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-017",
      "severity": "cosmetic",
      "category": "security",
      "threat": "Positive: Zero cookies, localStorage, sessionStorage, or indexedDB. Fully stateless site.",
      "evidence": "Re-searched all JS files. No storage API usage. CSP connect-src 'self' further restricts data exfiltration.",
      "attack_vector": "None.",
      "sovereignty_impact": "Positive. Full CARE compliance on data minimization.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-018",
      "severity": "cosmetic",
      "category": "third-party-risk",
      "threat": "Positive: System fonts only. No Google Fonts, no external font CDN.",
      "evidence": "CSS uses system font stack. No @font-face. CSP font-src 'self' prevents external font loading.",
      "attack_vector": "None. CSP now provides policy-level enforcement.",
      "sovereignty_impact": "Positive.",
      "fix": "No fix needed.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    },
    {
      "id": "DALE-019",
      "severity": "cosmetic",
      "category": "third-party-risk",
      "threat": "NEW FINDING: daily-scan.yml uses version-tagged GitHub Actions (actions/checkout@v4, actions/setup-python@v5) while the other two workflows were SHA-pinned in 18-04. This creates an inconsistency where the daily scan workflow is less protected against tag mutation attacks than the deployment workflows.",
      "evidence": "daily-scan.yml lines 16-17: uses: actions/checkout@v4 and uses: actions/setup-python@v5. Compare to deploy-website.yml which uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5.",
      "attack_vector": "A compromised action tag could inject code into the daily scan workflow. The scan outputs are committed to git (outputs/), so a compromised scan could push malicious content to the repository.",
      "sovereignty_impact": "Low. Daily scan outputs are review data, not public-facing advocacy documents. The deployment workflows that produce Tribal packets are properly SHA-pinned.",
      "fix": "Pin daily-scan.yml to the same SHAs: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 and actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065.",
      "paranoia_level": "cautious",
      "fix_status": "new",
      "new_severity": "P3",
      "new_rationale": "Inconsistency in SHA pinning. Lower risk since daily-scan outputs are not public-facing documents."
    },
    {
      "id": "DALE-020",
      "severity": "cosmetic",
      "category": "security",
      "threat": "NEW FINDING (positive): CSP meta tag with frame-ancestors directive correctly allows SquareSpace embedding while blocking other origins. The CSP policy is well-structured: default-src 'self' provides baseline, script-src 'self' prevents XSS, connect-src 'self' prevents data exfiltration, font-src 'self' blocks external font tracking.",
      "evidence": "<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self'; font-src 'self'; connect-src 'self'; frame-ancestors 'self' *.squarespace.com\">",
      "attack_vector": "None. CSP is correctly configured.",
      "sovereignty_impact": "Positive. Policy-level enforcement of data sovereignty practices.",
      "fix": "No fix needed. CSP is well-implemented.",
      "paranoia_level": "justified",
      "fix_status": "verified_safe"
    }
  ],
  "third_party_inventory": [
    "github.com (hosting, CI/CD, static file serving)",
    "api.congress.gov (scraper: legislative data, requires API key, server-side only)",
    "api.usaspending.gov (scraper: spending data, no auth, server-side only)",
    "www.grants.gov (scraper: grant opportunities, no auth, server-side only)",
    "www.federalregister.gov (scraper: policy documents, no auth, server-side only)"
  ],
  "data_flow_map": "Client-side: User browser -> GitHub Pages (HTTPS, HSTS) -> static HTML/CSS/JS + tribes.json -> CSP restricts all sources to 'self' -> local Fuse.js search (SRI verified) -> DOCX download (direct file serve). Server-side (CI/CD only): GitHub Actions (SHA-pinned in deploy/generate, version-tagged in daily-scan) -> 4 federal API scrapers -> Python pipeline -> DOCX generation -> git push to docs/web/tribes/. No user data flows from client to server. No analytics. No cookies. No server-side processing of user requests. Privacy footer explicitly informs users.",
  "sovereignty_assessment": "The TCR Policy Scanner website honors Indigenous Data Sovereignty principles with measurable improvements from the 18-04 remediation. Improvements verified: (1) CSP meta tag provides policy-level enforcement of no-external-scripts practice, (2) SRI hash on Fuse.js prevents supply chain tampering, (3) Privacy footer explicitly informs users about data handling ('No tracking. No cookies. Your searches stay on your device.'), (4) SHA-pinned deployment workflows prevent CI/CD supply chain attacks on public-facing documents, (5) noscript fallback provides repository link for JS-disabled users. Remaining gaps: (1) GitHub Pages access logs outside audit control (DALE-003, platform inherent), (2) daily-scan.yml not SHA-pinned (DALE-019, low risk for non-public outputs). Overall: the system is well-designed for data sovereignty. The CSP + SRI + privacy footer combination demonstrates proactive sovereignty compliance beyond minimum requirements.",
  "undrip_ocap_care_checklist": {
    "UNDRIP_Article_18": "COMPLIANT - Self-determined policy intelligence for Tribal advocacy",
    "UNDRIP_Article_31": "COMPLIANT - No Indigenous Knowledge collected or displayed",
    "OCAP_Ownership": "COMPLIANT - All data from public EPA NCOD registry",
    "OCAP_Control": "COMPLIANT - T0 enforced at pipeline level",
    "OCAP_Access": "COMPLIANT - Packets freely accessible",
    "OCAP_Possession": "N/A - T0 data intentionally public",
    "CARE_Collective_Benefit": "FULL - Zero tracking, zero analytics, CSP enforced",
    "CARE_Authority_Control": "PARTIAL - GitHub access logs outside audit (platform inherent)",
    "CARE_Responsibility": "IMPROVED - Privacy footer now informs users",
    "CARE_Ethics": "FULL - Data minimization (no cookies, no storage, no PII)"
  }
}

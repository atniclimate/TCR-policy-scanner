{
  "agent": "Marie Kondo",
  "clone_id": "frontend|pipeline",
  "timestamp": "2026-02-14T00:22:00Z",
  "audit_wave": 2,
  "previous_audit": "2026-02-13T22:55:00Z",
  "context": "Post-fix re-audit after Plan 18-04 code hygiene remediation. CFDA consolidation, manifest script extraction, PROJECT_ROOT cleanup, and TRIBAL_AWARD_TYPE_CODES derivation all verified.",
  "inventory": {
    "dependencies": {
      "total": 13,
      "used": 11,
      "unused": 0,
      "replaceable": 2,
      "items": [
        {
          "name": "aiohttp",
          "status": "essential",
          "imported_by": ["src/scrapers/base.py", "src/scrapers/usaspending.py", "src/health.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for enabling concurrent API scraping across 4 federal data sources.",
          "fix_status": "verified_safe"
        },
        {
          "name": "pydantic",
          "status": "essential",
          "imported_by": ["src/packets/models.py", "src/packets/confidence.py", "src/packets/context.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for providing structured validation for congressional intelligence models.",
          "fix_status": "verified_safe"
        },
        {
          "name": "python-dateutil",
          "status": "used",
          "imported_by": ["src/analysis/change_detector.py", "src/scrapers/base.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for flexible date parsing across inconsistent federal API date formats.",
          "fix_status": "verified_safe"
        },
        {
          "name": "jinja2",
          "status": "used",
          "imported_by": ["src/reports/generator.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for templating the markdown briefing reports.",
          "fix_status": "verified_safe"
        },
        {
          "name": "rapidfuzz",
          "status": "essential",
          "imported_by": ["src/packets/registry.py", "scripts/populate_awards.py", "scripts/generate_ha_aliases.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for enabling 85% fuzzy matching threshold for Tribal name resolution across 592 Nations.",
          "fix_status": "verified_safe"
        },
        {
          "name": "pyyaml",
          "status": "replaceable",
          "imported_by": ["src/monitors/base.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "evaluate -- used only in monitor base class. Low priority.",
          "gratitude": "Thank you for readable monitor configuration.",
          "fix_status": "deferred",
          "deferral_reason": "Single import site, low priority. Stdlib json could replace but requires config file conversion."
        },
        {
          "name": "python-docx",
          "status": "essential",
          "imported_by": ["src/packets/docx_engine.py", "src/packets/docx_sections.py", "src/packets/docx_hotsheet.py", "src/packets/docx_styles.py", "src/packets/docx_regional_sections.py", "scripts/validate_docx_structure.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for generating 992 DOCX advocacy packets that serve 592 Tribal Nations.",
          "fix_status": "verified_safe"
        },
        {
          "name": "openpyxl",
          "status": "used",
          "imported_by": ["src/reports/generator.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "keep",
          "gratitude": "Thank you for Excel report generation.",
          "fix_status": "verified_safe"
        },
        {
          "name": "requests",
          "status": "replaceable",
          "imported_by": ["scripts/download_nri_data.py", "scripts/download_usfs_data.py"],
          "size_impact": "N/A (server-side)",
          "recommendation": "evaluate -- used only in 2 download scripts. Low priority.",
          "gratitude": "Thank you for reliable HTTP downloads.",
          "fix_status": "deferred",
          "deferral_reason": "Two import sites, low priority. Stdlib urllib could replace."
        },
        {
          "name": "geopandas",
          "status": "used",
          "imported_by": ["scripts/build_area_crosswalk.py"],
          "size_impact": "N/A (build-time only)",
          "recommendation": "keep",
          "gratitude": "Thank you for geographic area calculations.",
          "fix_status": "verified_safe"
        },
        {
          "name": "shapely",
          "status": "used",
          "imported_by": ["scripts/build_area_crosswalk.py"],
          "size_impact": "N/A (build-time only)",
          "recommendation": "keep -- geopandas transitive",
          "gratitude": "Thank you for geometric intersection calculations.",
          "fix_status": "verified_safe"
        },
        {
          "name": "pyproj",
          "status": "used",
          "imported_by": ["scripts/build_area_crosswalk.py"],
          "size_impact": "N/A (build-time only)",
          "recommendation": "keep -- geopandas transitive",
          "gratitude": "Thank you for CRS transformations.",
          "fix_status": "verified_safe"
        },
        {
          "name": "pyogrio",
          "status": "used",
          "imported_by": ["scripts/build_area_crosswalk.py"],
          "size_impact": "N/A (build-time only)",
          "recommendation": "keep -- fast I/O backend for geopandas",
          "gratitude": "Thank you for fast shapefile reading.",
          "fix_status": "verified_safe"
        }
      ]
    },
    "code": {
      "total_issues": 12,
      "items": [
        {
          "name": "scripts/_add_curated_aliases_round3.py",
          "status": "removed",
          "file": "scripts/_add_curated_aliases_round3.py",
          "recommendation": "Removed in Wave 1.",
          "gratitude": "Thank you for your service. You live on in data/tribal_aliases.json.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-02 (924e9ac): File deleted.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "scripts/_add_curated_aliases_round4.py",
          "status": "removed",
          "file": "scripts/_add_curated_aliases_round4.py",
          "recommendation": "Removed in Wave 1.",
          "gratitude": "Thank you for the fourth round of curation.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-02 (924e9ac): File deleted.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "scripts/_add_curated_aliases_round5.py",
          "status": "removed",
          "file": "scripts/_add_curated_aliases_round5.py",
          "recommendation": "Removed in Wave 1.",
          "gratitude": "Thank you for the final round of refinement.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-02 (924e9ac): File deleted.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "scripts/_add_curated_aliases_tmp.py",
          "status": "removed",
          "file": "scripts/_add_curated_aliases_tmp.py",
          "recommendation": "Removed in Wave 1.",
          "gratitude": "Thank you for your temporary service.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-02 (924e9ac): File deleted.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "CFDA_TO_PROGRAM consolidation (MK-CODE-05)",
          "status": "consolidated",
          "file": "src/scrapers/cfda_map.py",
          "recommendation": "Consolidated. Single source of truth.",
          "gratitude": "Thank you, cfda_map.py, for unifying what was once scattered. 14 CFDA numbers, one canonical home.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-04 (c1c3d43): Created src/scrapers/cfda_map.py with canonical CFDA_TO_PROGRAM dict. Both grants_gov.py and usaspending.py now import from cfda_map. grants_gov.py maintains backward-compatible CFDA_NUMBERS alias. Verified: both scrapers use the same 14 CFDA entries.",
          "fix_verified_at": "2026-02-14T00:22:00Z",
          "verification_details": "Checked imports: src/scrapers/grants_gov.py line 18: 'from src.scrapers.cfda_map import CFDA_TO_PROGRAM'. src/scrapers/usaspending.py line 23: 'from src.scrapers.cfda_map import CFDA_TO_PROGRAM'. grants_gov.py line 25: 'CFDA_NUMBERS = CFDA_TO_PROGRAM' (backward compat alias). cfda_map.py contains 14 entries. No duplicate CFDA mappings remain."
        },
        {
          "name": "TRIBAL_AWARD_TYPE_CODES derivation (MK-CODE-06)",
          "status": "derived",
          "file": "src/scrapers/usaspending.py",
          "recommendation": "Derived from grouped list. Clean.",
          "gratitude": "Thank you for the elegant list comprehension.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-04 (c1c3d43): TRIBAL_AWARD_TYPE_CODES now derived via list comprehension: [code for group in TRIBAL_AWARD_TYPE_CODE_GROUPS for code in group]. No hardcoded flat list. Verified: produces ['02', '03', '04', '05', '06', '10'] -- same 6 codes as before.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "docs/web/404.html",
          "status": "used",
          "file": "docs/web/404.html",
          "recommendation": "keep -- SPA routing fallback for GitHub Pages",
          "gratitude": "Thank you for handling deep link navigation.",
          "fix_status": "verified_safe"
        },
        {
          "name": "Unused import check: asyncio in congress_gov.py",
          "status": "used",
          "file": "src/scrapers/congress_gov.py",
          "recommendation": "keep -- asyncio.sleep is used for rate limiting",
          "gratitude": "Thank you for rate-limiting API requests.",
          "fix_status": "verified_safe"
        },
        {
          "name": "PROJECT_ROOT re-export removal (MK-CODE-09)",
          "status": "removed",
          "file": "src/config.py",
          "recommendation": "Re-export removed. config.py no longer re-exports PROJECT_ROOT.",
          "gratitude": "Thank you, config.py, for letting go of what was not yours to keep. paths.py is the canonical home now.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-04 (c1c3d43): PROJECT_ROOT removed from config.py __all__ and re-export. Verified: grep for 'PROJECT_ROOT' in config.py returns no matches. No imports of PROJECT_ROOT from src.config found in the codebase.",
          "fix_verified_at": "2026-02-14T00:22:00Z"
        },
        {
          "name": "pyyaml import",
          "status": "used",
          "file": "src/monitors/base.py",
          "recommendation": "evaluate -- replaceable with stdlib json. Low priority.",
          "gratitude": "Thank you for readable YAML configuration.",
          "fix_status": "deferred",
          "deferral_reason": "Single import site, lightweight dependency, low priority."
        },
        {
          "name": "requests import",
          "status": "used",
          "file": "scripts/download_nri_data.py, scripts/download_usfs_data.py",
          "recommendation": "evaluate -- replaceable with urllib.request. Low priority.",
          "gratitude": "Thank you for reliable downloads.",
          "fix_status": "deferred",
          "deferral_reason": "Two import sites, widely installed, low priority."
        },
        {
          "name": "Manifest script extraction (MK-CODE-12)",
          "status": "extracted",
          "file": "scripts/build_manifest.py",
          "recommendation": "Extracted. Single source of truth for manifest generation.",
          "gratitude": "Thank you, build_manifest.py, for consolidating what two workflows once duplicated. A tidy script is a trustworthy script.",
          "fix_status": "verified_fixed",
          "fix_applied": "18-04 (c1c3d43): Created scripts/build_manifest.py with build_manifest() function. Both deploy-website.yml and generate-packets.yml now call 'python scripts/build_manifest.py' instead of inline manifest generation code. Verified: script uses datetime.now(timezone.utc), encoding='utf-8', pathlib.Path throughout. Correct document counting for all 4 subdirectories.",
          "fix_verified_at": "2026-02-14T00:22:00Z",
          "verification_details": "Checked: deploy-website.yml line 50: 'run: python scripts/build_manifest.py'. generate-packets.yml line 81: 'run: python scripts/build_manifest.py'. No inline manifest generation code remains in either workflow. build_manifest.py handles internal, congressional, regional_internal, regional_congressional counting."
        }
      ]
    },
    "configuration": {
      "total_issues": 3,
      "items": [
        {
          "name": "docs/web/data/ directory",
          "status": "used",
          "file": "docs/web/data/",
          "recommendation": "keep",
          "gratitude": "Thank you for organizing web data.",
          "fix_status": "verified_safe"
        },
        {
          "name": "docs/web/tribes/ directory",
          "status": "used",
          "file": "docs/web/tribes/",
          "recommendation": "keep",
          "gratitude": "Thank you for organizing documents by audience.",
          "fix_status": "verified_safe"
        },
        {
          "name": ".planning/ directory",
          "status": "used",
          "file": ".planning/",
          "recommendation": "keep",
          "gratitude": "Thank you for structured planning that brought this project to 964 tests.",
          "fix_status": "verified_safe"
        }
      ]
    },
    "new_files_audit": {
      "description": "Audit of files created by 18-04 remediation wave",
      "items": [
        {
          "name": "src/scrapers/cfda_map.py",
          "lines": 27,
          "assessment": "Clean. Single responsibility: canonical CFDA-to-program mapping. Type-annotated dict. 14 entries with inline comments. Module docstring explains purpose and MK-CODE-05 origin. No imports needed. Sparks joy.",
          "fix_status": "verified_safe"
        },
        {
          "name": "scripts/build_manifest.py",
          "lines": 74,
          "assessment": "Clean. Uses pathlib throughout, encoding='utf-8', datetime.now(timezone.utc) (not deprecated utcnow()). Proper if __name__ == '__main__' guard. Function docstring with args/returns. Handles missing subdirectories gracefully. Sparks joy.",
          "fix_status": "verified_safe"
        }
      ]
    }
  },
  "joy_score": 9,
  "joy_score_previous": 8,
  "joy_score_potential": 10,
  "joy_analysis": "This codebase now sparks even more joy. The 18-04 remediation addressed the 4 highest-priority hygiene items: (1) CFDA mapping consolidated into single source of truth (cfda_map.py), (2) TRIBAL_AWARD_TYPE_CODES derived via list comprehension instead of duplicated flat list, (3) PROJECT_ROOT re-export removed from config.py, (4) manifest generation extracted to shared script. The 4 dead migration scripts were already removed in Wave 1. The new files (cfda_map.py, build_manifest.py) are clean, well-documented, and follow all project patterns (encoding, pathlib, docstrings). Two low-priority items remain (pyyaml and requests replaceable with stdlib) but these do not affect the joy of working with this codebase. A 10/10 is achievable with those two replacements, but a 9/10 is already a codebase that sparks genuine joy. Every module has purpose. Every function is called. Every dependency is justified."
}
